# 项目：波动方程的FTCS解 - 实验报告

**学生姓名：** [樊一川] **学号：** [20221050017] **完成日期：** [2025/6/18]

## 1. 实验目的

本实验旨在通过有限差分法（FTCS方案）模拟一维波动方程，理解其数值求解过程，并可视化弦的振动。

## 2. 核心算法

### 2.1 算法思路

本实验采用FTCS（Forward-Time Central-Space）方案求解一维波动方程。首先，将连续的波动方程离散化为差分方程。然后，根据给定的初始条件（初始位移和初始速度）计算第一个时间步的弦位移。接着，通过迭代更新公式，从已知的前两个时间步的位移计算出当前时间步的位移，直到模拟结束。在整个过程中，严格遵守边界条件，即弦的两端位移始终为零。

### 2.2 关键代码片段

```python
# 核心代码段
# 例如：FTCS更新公式的实现
# for j in range(1, t.size - 1):
#     u[1:-1, j + 1] = c_val * (u[2:, j] + u[:-2, j]) + 2 * (1 - c_val) * u[1:-1, j] - u[1:-1, j - 1]
for j in range(1, t.size - 1):
        u[1:-1, j + 1] = c_val * (u[2:, j] + u[:-2, j]) + 2 * (1 - c_val) * u[1:-1, j] - u[1:-1, j - 1]

    return u, x, t
```

## 3. 实验结果

### 3.1 主要输出

[请在此处插入关键数值结果或生成的动画截图/描述。例如，不同时间点的弦形图，或动画的简要描述。]
![wave_equation](https://github.com/user-attachments/assets/6fd45b67-8393-4d64-8455-004ee4e2c847)
该动画展示了一维弦振动的传播过程。横轴为弦的位置，纵轴为弦的位移。随着时间推移，初始速度激发的波动在弦上来回传播，反映了波动方程的数值解随时间的动态变化。

### 3.2 结果验证

[请在此处描述如何验证你的结果的正确性。例如，是否满足边界条件？波形是否符合预期？是否观察到数值稳定性问题？]

边界条件验证：检查动画和数据，确认弦两端（x=0 和 x=L）始终保持为零位移，满足固定端边界条件。

波形合理性：观察波动传播过程，波形应在弦上往返反射，且形状与初始激发相符，无异常畸变。

数值稳定性：若动画中波形逐步发散或出现非物理振荡，说明数值方案不稳定。可通过减小时间步长 dt 或检查稳定性条件 c < 1 进行验证。



## 4. 问题与收获

### 4.1 主要问题

[请在此处列出你在实验过程中遇到的1-2个主要困难，例如：
*   如何处理初始速度条件？
*   如何确保数值稳定性？
*   动画制作中的挑战？]

在动画保存时遇到了问题，保存速度太慢

### 4.2 解决方法

[请在此处描述你如何解决上述问题。例如：
*   查阅资料理解初始速度的离散化方法。
*   调整时间步长以满足CFL条件。
*   学习Matplotlib动画模块的使用。]

选择若干帧提取，进行保存，加快速度

### 4.3 主要收获

加深了对波动方程和有限差分法的理解。
   
掌握了Python进行科学计算和可视化的技能。
   
认识到数值模拟中稳定性条件的重要性。


## 5. 思考题（可选）

1.  如果改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式会有什么变化？
   改变初始速度剖面 $\psi(x)$ 的形状，弦的振动模式也会随之变化，波形的传播和反射方式会不同，激发出不同的振动模式和频率成分。

2.  尝试使用不同的 $\Delta t$ 和 $\Delta x$ 值，观察数值解的稳定性和准确性如何受到影响。当 $c \ge 1$ 时会发生什么？
   使用不同的 $\Delta t$ 和 $\Delta x$ 会影响数值解的稳定性和精度。当 $c \ge 1$ 时，数值解会变得不稳定，出现发散或非物理振荡。
