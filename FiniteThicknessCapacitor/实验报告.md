# 项目：有限厚平行板电容器电荷分布分析 - 实验报告

**学生姓名：** [杨思羽] **学号：** [20221050076] **完成日期：** [2025/6/18]

## 1. 实验目的

本实验的学习目标是掌握有限厚度平行板电容器的数值建模方法，理解其电势分布的计算过程。要解决的物理问题是分析有限厚度极板间的电势分布及边缘效应对电场的影响。


## 2. 核心算法
SOR（超松弛迭代）法是一种加速收敛的迭代方法，用于求解拉普拉斯方程等线性方程组。其基本思路是在每次迭代时，利用当前和前一步的结果对解进行加权更新，从而提高收敛速度。实现步骤包括：首先初始化电势分布，然后在每个非边界点按SOR公式更新电势值，更新时需用到松弛因子ω（1<ω<2），不断迭代直到整体误差低于设定阈值。通过合理选择松弛因子，可以显著减少迭代次数，提高计算效率。
### 2.1 算法思路
初始化电势分布，对所有非边界点按SOR公式逐点更新电势值，保持边界条件不变。不断重复迭代，直到所有点的电势变化小于预设的收敛阈值。

### 2.2 关键代码片段

```python
for iteration in range(max_iter):
        U_old = U.copy()
        max_error = 0
        # Update potential using SOR formula
        for i in range(1, ny-1):
            for j in range(1, nx-1):
                if not conductor_mask[i, j]:  # Skip conductor points
                    # SOR update formula
                    U_new = 0.25 * (U[i+1, j] + U[i-1, j] + U[i, j+1] + U[i, j-1])
                    U[i, j] = (1 - omega) * U[i, j] + omega * U_new
                    
                    # Track maximum error
                    error = abs(U[i, j] - U_old[i, j])
                    max_error = max(max_error, error)
        
        # Check convergence
        if max_error < tolerance:
            print(f"Converged after {iteration + 1} iterations")
            break
    else:
        print(f"Warning: Maximum iterations ({max_iter}) reached")）

```

## 3. 实验结果

### 3.1 主要输出
![finite](https://github.com/user-attachments/assets/21726ae6-098d-4eb7-b9bc-9bb7cc45c337)

首先，收敛迭代次数反映了SOR方法达到预设收敛精度所需的迭代步数。其次，电势范围显示了整个计算区域内电势的最大值和最小值，通常应接近极板设定的±100V。最后，电荷分布特征可通过计算极板表面的电场或电荷密度分布，反映出有限厚度极板边缘处电荷集中的现象和整体分布规律。这些结果有助于分析电容器模型的物理特性和数值方法的有效性。

### 3.2 结果验证

首先，检查边界条件，确保极板区域的电势始终保持在设定值（如±100V），其余边界满足题设要求。其次，分析电势分布是否平滑且符合物理预期，例如极板间电势近似线性分布，极板外部电势逐渐衰减。还可以计算电场和电荷分布，判断是否在极板边缘出现合理的边缘效应。最后，将数值结果与理论解或已知特例进行对比，进一步验证程序的准确性。

## 4. 问题与收获

### 4.1 主要问题

如何计算电荷密度分布

### 4.2 解决方法

刚开始用以下代码：
```python
    V = potential_grid
    d2V_dx2 = (np.roll(V, -1, axis=1) - 2 * V + np.roll(V, 1, axis=1)) / (dx**2)
    d2V_dy2 = (np.roll(V, -1, axis=0) - 2 * V + np.roll(V, 1, axis=0)) / (dy**2)
    rho = - (d2V_dx2 + d2V_dy2) / (4 * np.pi)
    return rho
```
但无法实现电荷密度的计算，参考了solution中用scipy.ndimage的laplace求解

### 4.3 主要收获

学会使用SOR（超松弛迭代）法求解拉普拉斯方程；回顾了有限厚度平行板电容器的电势分布的方程的建立，用了哪些边值条件

## 5. 思考题（可选）

### 5.1 松弛因子影响分析

当ω=1时，SOR方法退化为普通的高斯-赛德尔迭代，收敛速度较慢；当1<ω<2时，适当增大ω可以加快收敛速度，因为每次迭代对新解的更新幅度更大，有助于更快逼近真实解。但如果ω过大（接近或超过2），则可能导致迭代过程不稳定甚至发散。原因在于松弛因子调节了每步更新的“步长”，合理选择ω可以在保证稳定性的前提下显著提高迭代效率。

### 5.2 有限厚度效应

有限厚度电容器与理想薄板电容器在电场分布上存在明显差异。理想薄板电容器假设极板厚度可以忽略，极板间电场分布均匀，边缘效应极小，电场线几乎全部垂直于极板并集中在板间。而有限厚度电容器由于极板具有实际厚度，极板边缘和表面附近的电场分布会发生畸变，边缘效应更加明显，电场线在极板边缘附近会出现弯曲和扩散，导致极板外部也存在一定的电场。此外，有限厚度极板的电荷分布也更加复杂，边缘处电荷密度增大，整体电场分布更加接近实际物理情况。

### 5.3 数值精度讨论

网格分辨率直接影响计算电势和电场分布的精度。较高的网格分辨率（即更细的网格）能够更准确地描述极板边缘和电场变化细节，提高数值解的精度，但会显著增加计算量和内存消耗，导致计算效率降低。相反，较低的分辨率虽然计算速度快，但可能无法捕捉到边缘效应等重要物理特征。为了平衡精度与效率，通常需要根据问题的物理尺度和关注区域，选择合适的网格大小，或采用自适应网格等方法，在关键区域细化网格，在其他区域保持较粗分辨率，从而兼顾计算精度和效率。
